
<div class="container profile-father">

    <div class="profile-card">
      <div class="profile-username">
      <% if @profile.username.present? %>
        <h4><%= @profile.username %></h4>
      <% end %>
    </div>

    <div class="profile-picture-round">
      <% if @profile.photo.present? %>
        <%= cl_image_tag @profile.photo.key, class:"profile-pic" %>
      <% else %>
        <%= image_tag "Default_pfp.jpg", alt: "Default Profile Picture", class:"profile-pic" %>
      <% end %>
    </div>

    <div class="profile-names">
      <%= @profile.user.first_name %>
      <% if @profile.last_name.present? %>
        <p><%= @profile.last_name[0] %>.</p>
      <% end %>
    </div>

    <div class="profile-info">
      <div class="profile-age profile-text">
        <% if @profile.birthdate.present? %>
          <% age = Time.now.year - @profile.birthdate.year - ((Time.now.month > @profile.birthdate.month || (Time.now.month == @profile.birthdate.month && Time.now.day >= @profile.birthdate.day)) ? 0 : 1) %>
          <p>Age: <%= age %></p>
        <% end %>
      </div>
      <div class="profile-city profile-text">
        <% if @profile.city.present? %>
          <p><i class="fa-solid fa-location-dot"></i> <%= @profile.city %></p>
        <% end %>
      </div>
    </div>


  <div class="profile-text">
    <% if @profile.bio.present? %>
      <p>Bio: <%= @profile.bio %></p>
    <% end %>
    <% if @profile.interests.present? %>
      <p>Interests: <%= @profile.interests %></p>
    <% end %>
  </div>

  <div class="profile-events">
    <% @events.each do |event| %>
      <%= cl_image_tag event.photo.key, class: "card-image", height: 70, width: 70,  crop: :fill  %>
      <p>
        <%= event.name %>
      </p>
    <% end %>
  </div>

    <% if @profile.user == @user %>
        <%= link_to "Edit your profile", edit_profile_path(@profile), class:"btn chatedit" %>
    <% end  %>

    </div>



  <div class="chat">
      <% unless @profile == current_user.profile %>
      <% if @chatroom %>
        <div class="chat-message">
          <%= link_to "Message", chatroom_path(@chatroom), class:"btn chat-button" %>
        </div>
      <% else %>
        <div class="chat-message">
          <%= simple_form_for Chatroom.new do |f| %>
            <%= f.input :receiver_id, input_html: { class:"d-none", value: @profile.user.id } %>
            <%= f.input :sender_id, input_html: { class:"d-none", value: current_user.id } %>
            <%= f.submit %>
          <% end %>
        </div>
      <% end %>
    <% end %>

  </div>


</div>
